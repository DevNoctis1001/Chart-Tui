ne.util.defineNamespace("fedoc.content", {});
fedoc.content["tooltips_tooltip.js.html"] = "      <div id=\"main\" class=\"main\">\n\n\n\n    \n    <section>\n        <article>\n            <pre class=\"prettyprint source linenums\"><code>/**\n * @fileoverview Tooltip component.\n * @author NHN Ent.\n *         FE Development Team &lt;dl_javascript@nhnent.com>\n */\n\n'use strict';\n\nvar TooltipBase = require('./tooltipBase'),\n    chartConst = require('../const'),\n    predicate = require('../helpers/predicate'),\n    dom = require('../helpers/domHandler'),\n    eventListener = require('../helpers/eventListener'),\n    renderUtil = require('../helpers/renderUtil'),\n    templateMaker = require('../helpers/templateMaker'),\n    tooltipTemplate = require('./tooltipTemplate');\n\nvar Tooltip = tui.util.defineClass(TooltipBase, /** @lends Tooltip.prototype */ {\n    /**\n     * Tooltip component.\n     * @constructs Tooltip\n     * @param {object} params parameters\n     *      @param {array.&lt;number>} params.values converted values\n     *      @param {array} params.labels labels\n     *      @param {array} params.legendLabels legend labels\n     *      @param {object} params.bound axis bound\n     *      @param {object} params.theme axis theme\n     */\n    init: function(params) {\n        var values;\n        TooltipBase.call(this, params);\n        this.tplTooltip = this._getTooltipTemplate(this.options.template);\n        if (tui.util.isArray(this.values)) {\n            values = this.values;\n            this.values = {};\n            this.values[this.chartType] = values;\n        }\n    },\n\n    /**\n     * Get tooltip template.\n     * @param {object} optionTemplate template option\n     * @returns {object} template\n     * @private\n     */\n    _getTooltipTemplate: function(optionTemplate) {\n        return optionTemplate ? templateMaker.template(optionTemplate) : tooltipTemplate.tplDefault;\n    },\n\n    /**\n     * Set default align option of tooltip.\n     * @private\n     * @override\n     */\n    _setDefaultTooltipPositionOption: function() {\n        if (this.options.align) {\n            return;\n        }\n\n        if (this.isVertical) {\n            this.options.align = chartConst.TOOLTIP_DEFAULT_ALIGN_OPTION;\n        } else {\n            this.options.align = chartConst.TOOLTIP_DEFAULT_HORIZONTAL_ALIGN_OPTION;\n        }\n    },\n\n    /**\n     * To render tooltip component.\n     * @param {{position: object}} bound tooltip bound\n     * @param {?{seriesPosition: {left: number, top: number}}} data rendering data\n     * @returns {HTMLElement} tooltip element\n     * @override\n     */\n    render: function(bound, data) {\n        var el = TooltipBase.prototype.render.call(this, bound, data);\n\n        if (data) {\n            this.seriesPosition = data.seriesPosition;\n        }\n\n        this.attachEvent(el);\n        return el;\n    },\n\n    /**\n     * To resize tooltip component.\n     * @param {{position: object}} bound tooltip bound\n     * @param {?{seriesPosition: {left: number, top: number}}} data rendering data\n     * @override\n     */\n    resize: function(bound, data) {\n        if (data) {\n            this.seriesPosition = data.seriesPosition;\n        }\n        TooltipBase.prototype.resize.call(this, bound);\n    },\n\n    /**\n     * To make tooltip data.\n     * @returns {array.&lt;object>} tooltip data\n     * @override\n     */\n    makeTooltipData: function() {\n        var labels = this.labels,\n            tooltipData = {},\n            legendLabels = {};\n\n        if (tui.util.isArray(this.formattedValues)) {\n            tooltipData[this.chartType] = this.formattedValues;\n            legendLabels[this.chartType] = this.legendLabels;\n        } else {\n            tooltipData = this.formattedValues;\n            legendLabels = this.legendLabels;\n        }\n\n        tui.util.forEach(tooltipData, function(groupValues, chartType) {\n            tooltipData[chartType] = tui.util.map(groupValues, function(values, groupIndex) {\n                return tui.util.map(values, function(value, index) {\n                    return {\n                        category: labels ? labels[groupIndex] : '',\n                        legend: legendLabels[chartType][index],\n                        value: value\n                    };\n                });\n            });\n        });\n        return tooltipData;\n    },\n\n    /**\n     * Fire custom event showAnimation.\n     * @param {{groupIndex: number, index: number}} indexes indexes\n     * @param {string} chartType chart type\n     * @private\n     */\n    _fireShowAnimation: function(indexes, chartType) {\n        var eventName = renderUtil.makeCustomEventName('show', chartType, 'animation');\n        this.fire(eventName, indexes);\n    },\n\n    /**\n     * Fire custom event hideAnimation.\n     * @param {{groupIndex: number, index: number}} indexes indexes\n     * @param {string} chartType chart type\n     * @private\n     */\n    _fireHideAnimation: function(indexes, chartType) {\n        var eventName = renderUtil.makeCustomEventName('hide', chartType, 'animation');\n        this.fire(eventName, indexes);\n    },\n\n    /**\n     * Set data indexes.\n     * @param {HTMLElement} elTooltip tooltip element\n     * @param {{groupIndex: number, index:number}} indexes indexes\n     * @private\n     */\n    _setIndexesCustomAttribute: function(elTooltip, indexes) {\n        elTooltip.setAttribute('data-groupIndex', indexes.groupIndex);\n        elTooltip.setAttribute('data-index', indexes.index);\n    },\n\n    /**\n     * Get data indexes\n     * @param {HTMLElement} elTooltip tooltip element\n     * @returns {{groupIndex: number, index: number}} indexes\n     * @private\n     */\n    _getIndexesCustomAttribute: function(elTooltip) {\n        var groupIndex = elTooltip.getAttribute('data-groupIndex'),\n            index = elTooltip.getAttribute('data-index'),\n            indexes = null;\n\n        if (!tui.util.isNull(groupIndex) &amp;&amp; !tui.util.isNull(index)) {\n            indexes = {\n                groupIndex: parseInt(groupIndex, 10),\n                index: parseInt(index, 10)\n            };\n        }\n        return indexes;\n    },\n\n    /**\n     * Set showed custom attribute.\n     * @param {HTMLElement} elTooltip tooltip element\n     * @param {boolean} status whether showed or not\n     * @private\n     */\n    _setShowedCustomAttribute: function(elTooltip, status) {\n        elTooltip.setAttribute('data-showed', status);\n    },\n\n    /**\n     * Whether showed tooltip or not.\n     * @param {HTMLElement} elTooltip tooltip element\n     * @returns {boolean} whether showed tooltip or not\n     * @private\n     */\n    _isShowedTooltip: function(elTooltip) {\n        var isShowed = elTooltip.getAttribute('data-showed');\n        return isShowed === 'true' || isShowed === true; // ie7에서는 boolean형태의 true를 반환함\n    },\n\n    /**\n     * On mouseover event handler for tooltip area\n     * @param {MouseEvent} e mouse event\n     */\n    onMouseover: function(e) {\n        var elTarget = e.target || e.srcElement,\n            indexes, chartType;\n\n        if (!dom.hasClass(elTarget, chartConst.TOOLTIP_PREFIX)) {\n            elTarget = dom.findParentByClass(elTarget, chartConst.TOOLTIP_PREFIX);\n        }\n\n        indexes = this._getIndexesCustomAttribute(elTarget);\n        chartType = elTarget.getAttribute('data-chart-type');\n\n        this._setShowedCustomAttribute(elTarget, true);\n        this._fireShowAnimation(indexes, chartType);\n    },\n\n    /**\n     * On mouseout event handler for tooltip area\n     * @param {MouseEvent} e mouse event\n     */\n    onMouseout: function(e) {\n        var elTarget = e.target || e.srcElement;\n\n\n        if (!dom.hasClass(elTarget, chartConst.TOOLTIP_PREFIX)) {\n            elTarget = dom.findParentByClass(elTarget, chartConst.TOOLTIP_PREFIX);\n        }\n\n        this.hideTooltip(elTarget);\n    },\n\n    /**\n     * To calculate tooltip position abount pie chart.\n     * @param {object} params parameters\n     *      @param {{left: number, top: number}} params.bound bound\n     *      @param {{clientX: number, clientY: number}} params.eventPosition mouse position\n     * @returns {{top: number, left: number}} position\n     * @private\n     */\n    _calculateTooltipPositionAboutPieChart: function(params) {\n        params.bound.left = params.eventPosition.clientX - this.seriesPosition.left;\n        params.bound.top = params.eventPosition.clientY - this.seriesPosition.top;\n        return this._calculateTooltipPositionAboutNotBarChart(params);\n    },\n\n    /**\n     * To calculate tooltip position about not bar chart.\n     * @param {object} params parameters\n     *      @param {{bound: object}} params.data graph information\n     *      @param {{width: number, height: number}} params.dimension tooltip dimension\n     *      @param {string} params.alignOption position option (ex: 'left top')\n     * @returns {{top: number, left: number}} position\n     * @private\n     */\n    _calculateTooltipPositionAboutNotBarChart: function(params) {\n        var bound = params.bound,\n            positionOption = params.positionOption,\n            minusWidth = params.dimension.width - (bound.width || 0),\n            lineGap = bound.width ? 0 : chartConst.TOOLTIP_GAP,\n            alignOption = params.alignOption || '',\n            tooltipHeight = params.dimension.height,\n            result = {};\n        result.left = bound.left + positionOption.left;\n        result.top = bound.top - tooltipHeight + positionOption.top;\n\n        if (alignOption.indexOf('left') > -1) {\n            result.left -= minusWidth + lineGap;\n        } else if (alignOption.indexOf('center') > -1) {\n            result.left -= minusWidth / 2;\n        } else {\n            result.left += lineGap;\n        }\n\n        if (alignOption.indexOf('bottom') > -1) {\n            result.top += tooltipHeight + lineGap;\n        } else if (alignOption.indexOf('middle') > -1) {\n            result.top += tooltipHeight / 2;\n        } else {\n            result.top -= chartConst.TOOLTIP_GAP;\n        }\n\n        return result;\n    },\n\n    /**\n     * To calculate tooltip position about bar chart.\n     * @param {object} params parameters\n     *      @param {{bound: object}} params.data graph information\n     *      @param {{width: number, height: number}} params.dimension tooltip dimension\n     *      @param {string} params.alignOption position option (ex: 'left top')\n     * @returns {{top: number, left: number}} position\n     * @private\n     */\n    _calculateTooltipPositionAboutBarChart: function(params) {\n        var bound = params.bound,\n            positionOption = params.positionOption,\n            minusHeight = params.dimension.height - (bound.height || 0),\n            alignOption = params.alignOption || '',\n            tooltipWidth = params.dimension.width,\n            result = {};\n\n        result.left = bound.left + bound.width + positionOption.left;\n        result.top = bound.top + positionOption.top;\n\n        // TODO : alignOptions을 객체로 만들어서 검사하도록 변경하기 ex) alignOption.left = true\n        if (alignOption.indexOf('left') > -1) {\n            result.left -= tooltipWidth;\n        } else if (alignOption.indexOf('center') > -1) {\n            result.left -= tooltipWidth / 2;\n        } else {\n            result.left += chartConst.TOOLTIP_GAP;\n        }\n\n        if (alignOption.indexOf('top') > -1) {\n            result.top -= minusHeight;\n        } else if (alignOption.indexOf('middle') > -1) {\n            result.top -= minusHeight / 2;\n        }\n\n        return result;\n    },\n\n    /**\n     * Adjust position.\n     * @param {{width: number, height: number}} chartDimension chart dimension\n     * @param {{left: number, top: number}} areaPosition area position\n     * @param {{width: number, height: number}} tooltipDimension tooltip dimension\n     * @param {{left: number, top: number}} position position\n     * @returns {{left: number, top: number}} adjusted position\n     * @private\n     */\n    _adjustPosition: function(chartDimension, areaPosition, tooltipDimension, position) {\n        position.left = tui.util.max([position.left, -areaPosition.left]);\n        position.left = tui.util.min([position.left, chartDimension.width - areaPosition.left - tooltipDimension.width]);\n        position.top = tui.util.max([position.top, -areaPosition.top]);\n        position.top = tui.util.min([position.top, chartDimension.height - areaPosition.top - tooltipDimension.height]);\n        return position;\n    },\n\n    /**\n     * Calculate tooltip position.\n     * @param {object} params parameters\n     *      @param {{left: number, top: number, width: number, height: number}} params.bound graph bound\n     *      @param {string} params.chartType chart type\n     *      @param {boolean} params.allowNegativeTooltip whether allow negative tooltip or not\n     *      @param {{width: number, height: number}} params.dimension tooltip dimension\n     *      @param {string} params.alignOption position option (ex: 'left top')\n     * @returns {{top: number, left: number}} position\n     * @private\n     */\n    _calculateTooltipPosition: function(params) {\n        var position = {},\n            sizeType, positionType, addPadding;\n\n        if (params.eventPosition) {\n            return this._calculateTooltipPositionAboutPieChart(params);\n        }\n\n        if (predicate.isBarChart(params.chartType)) {\n            position = this._calculateTooltipPositionAboutBarChart(params);\n            sizeType = 'width';\n            positionType = 'left';\n            addPadding = 1;\n        } else {\n            position = this._calculateTooltipPositionAboutNotBarChart(params);\n            sizeType = 'height';\n            positionType = 'top';\n            addPadding = -1;\n        }\n\n        if (params.allowNegativeTooltip) {\n            position = this._moveToSymmetry(position, {\n                bound: params.bound,\n                indexes: params.indexes,\n                dimension: params.dimension,\n                chartType: params.chartType,\n                sizeType: sizeType,\n                positionType: positionType,\n                addPadding: addPadding\n            });\n        }\n\n        position = this._adjustPosition(this.chartDimension, this.bound.position, params.dimension, position);\n        return position;\n    },\n\n    /**\n     * Get value by indexes.\n     * @param {{groupIndex: number, index: number}} indexes indexes\n     * @param {string} chartType chart type\n     * @returns {(string | number)} value\n     * @private\n     */\n    _getValueByIndexes: function(indexes, chartType) {\n        return this.values[chartType][indexes.groupIndex][indexes.index];\n    },\n\n    /**\n     * Move to symmetry.\n     * @param {{left: number, top: number}} position tooltip position\n     * @param {object} params parameters\n     *      @param {{left: number, top: number, width: number, height: number}} params.bound graph bound\n     *      @param {string} params.id tooltip id\n     *      @param {{width: number, height: number}} params.dimension tooltip dimension\n     *      @param {string} params.sizeType size type (width or height)\n     *      @param {string} params.positionType position type (left or top)\n     *      @param {number} params.addPadding add padding\n     * @returns {{left: number, top: number}} moved position\n     * @private\n     */\n    _moveToSymmetry: function(position, params) {\n        var bound = params.bound,\n            sizeType = params.sizeType,\n            positionType = params.positionType,\n            value = this._getValueByIndexes(params.indexes, params.chartType),\n            center;\n        if (value &lt; 0) {\n            center = bound[positionType] + (bound[sizeType] / 2) + (params.addPadding || 0);\n            position[positionType] = position[positionType] - (position[positionType] - center) * 2 - params.dimension[sizeType];\n        }\n        return position;\n    },\n\n    /**\n     * To make tooltip html.\n     * @param {string} chartType chart type\n     * @param {{groupIndex: number, index: number}} indexes indexes\n     * @returns {string} tooltip html\n     * @private\n     */\n    _makeTooltipHtml: function(chartType, indexes) {\n        var data = this.data[chartType][indexes.groupIndex][indexes.index];\n        data.suffix = this.suffix;\n        return this.tplTooltip(data);\n    },\n\n    /**\n     * Whether changed indexes or not.\n     * @param {{groupIndex: number, index: number}} prevIndexes prev indexes\n     * @param {{groupIndex: number, index: number}} indexes indexes\n     * @returns {boolean} whether changed or not\n     * @private\n     */\n    _isChangedIndexes: function(prevIndexes, indexes) {\n        return !!prevIndexes &amp;&amp; (prevIndexes.groupIndex !== indexes.groupIndex || prevIndexes.index !== indexes.index);\n    },\n\n    /**\n     * Show tooltip.\n     * @param {HTMLElement} elTooltip tooltip element\n     * @param {{indexes: {groupIndex: number, index: number}, bound: object}} params tooltip data\n     * @param {{left: number, top: number}} prevPosition prev position\n     */\n    showTooltip: function(elTooltip, params, prevPosition) {\n        var indexes = params.indexes,\n            prevIndexes = this._getIndexesCustomAttribute(elTooltip),\n            prevChartType, position;\n        if (this._isChangedIndexes(prevIndexes, indexes)) {\n            prevChartType = elTooltip.getAttribute('data-chart-type');\n            this._fireHideAnimation(prevIndexes, prevChartType);\n        }\n\n        elTooltip.innerHTML = this._makeTooltipHtml(params.chartType, indexes);\n\n        elTooltip.setAttribute('data-chart-type', params.chartType);\n        this._setIndexesCustomAttribute(elTooltip, indexes);\n        this._setShowedCustomAttribute(elTooltip, true);\n\n        this._fireBeforeShowTooltip(indexes);\n\n        dom.addClass(elTooltip, 'show');\n\n        position = this._calculateTooltipPosition(tui.util.extend({\n            dimension: this.getTooltipDimension(elTooltip),\n            positionOption: tui.util.extend({\n                left: 0,\n                top: 0\n            }, this.options.position),\n            alignOption: this.options.align || ''\n        }, params));\n\n        this.moveToPosition(elTooltip, position, prevPosition);\n        this._fireShowAnimation(indexes, params.chartType);\n        this._fireAfterShowTooltip(indexes, {\n            element: elTooltip,\n            position: position\n        });\n    },\n\n    /**\n     * To make parameters for show tooltip user event.\n     * @param {{groupIndex: number, index: number}} indexes indexes\n     * @param {object} additionParams addition parameters\n     * @returns {{chartType: string, legend: string, legendIndex: number, index: number}} parameters for show tooltip\n     * @private\n     */\n    _makeShowTooltipParams: function(indexes, additionParams) {\n        var legendIndex = indexes.index,\n            legendData = this.joinLegendLabels[legendIndex],\n            params;\n        params = tui.util.extend({\n            chartType: legendData.chartType,\n            legend: legendData.label,\n            legendIndex: legendIndex,\n            index: indexes.groupIndex\n        }, additionParams);\n        return params;\n    },\n\n    /**\n     * To call beforeShowTooltip callback of userEvent.\n     * @param {{groupIndex: number, index: number}} indexes indexes\n     * @private\n     */\n    _fireBeforeShowTooltip: function(indexes) {\n        var params = this._makeShowTooltipParams(indexes);\n        this.userEvent.fire('beforeShowTooltip', params);\n    },\n\n    /**\n     * To call afterShowTooltip callback of userEvent.\n     * @param {{groupIndex: number, index: number}} indexes indexes\n     * @param {object} additionParams addition parameters\n     * @private\n     */\n    _fireAfterShowTooltip: function(indexes, additionParams) {\n        var params = this._makeShowTooltipParams(indexes, additionParams);\n        this.userEvent.fire('afterShowTooltip', params);\n    },\n\n    /**\n     * Hide tooltip.\n     * @param {HTMLElement} elTooltip tooltip element\n     * @param {function} callback callback\n     */\n    hideTooltip: function(elTooltip) {\n        var that = this,\n            indexes = this._getIndexesCustomAttribute(elTooltip),\n            chartType = elTooltip.getAttribute('data-chart-type');\n\n        this._setShowedCustomAttribute(elTooltip, false);\n        this._fireHideAnimation(indexes, chartType);\n\n        if (this._isChangedIndexes(this.prevIndexes, indexes)) {\n            delete this.prevIndexes;\n        }\n\n        setTimeout(function() {\n            if (that._isShowedTooltip(elTooltip)) {\n                return;\n            }\n            that.hideAnimation(elTooltip);\n\n            that = null;\n            indexes = null;\n        }, chartConst.HIDE_DELAY);\n    },\n\n    /**\n     * Attach event\n     * @param {HTMLElement} el target element\n     */\n    attachEvent: function(el) {\n        eventListener.bindEvent('mouseover', el, tui.util.bind(this.onMouseover, this));\n        eventListener.bindEvent('mouseout', el, tui.util.bind(this.onMouseout, this));\n    }\n});\n\ntui.util.CustomEvents.mixin(Tooltip);\n\nmodule.exports = Tooltip;\n</code></pre>\n        </article>\n    </section>\n\n\n\n</div>\n\n"