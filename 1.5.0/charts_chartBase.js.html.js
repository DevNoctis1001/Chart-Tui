tui.util.defineNamespace("fedoc.content", {});
fedoc.content["charts_chartBase.js.html"] = "      <div id=\"main\" class=\"main\">\n\n\n\n    \n    <section>\n        <article>\n            <pre class=\"prettyprint source linenums\"><code>/**\n * @fileoverview ChartBase\n * @author NHN Ent.\n *         FE Development Team &lt;dl_javascript@nhnent.com>\n */\n\n'use strict';\n\nvar dom = require('../helpers/domHandler'),\n    renderUtil = require('../helpers/renderUtil'),\n    DefaultDataProcessor = require('../helpers/dataProcessor'),\n    BoundsMaker = require('../helpers/boundsMaker'),\n    ComponentManager = require('./componentManager'),\n    UserEventListener = require('../helpers/userEventListener');\n\nvar ChartBase = tui.util.defineClass(/** @lends ChartBase.prototype */ {\n    /**\n     * Chart base.\n     * @constructs ChartBase\n     * @param {object} params parameters\n     *      @param {object} params.rawData raw data\n     *      @param {object} params.theme chart theme\n     *      @param {object} params.options chart options\n     *      @param {boolean} params.hasAxes whether has axes or not\n     *      @param {boolean} params.isVertical whether vertical or not\n     *      @param {DataProcessor} params.DataProcessor DataProcessor\n     */\n    init: function(params) {\n        /**\n         * raw data.\n         * @type {object}\n         */\n        this.rawData = params.rawData;\n\n        /**\n         * theme\n         * @type {object}\n         */\n        this.theme = params.theme;\n\n        /**\n         * options\n         * @type {object}\n         */\n        this.options = params.options;\n\n        /**\n         * chart type\n         * @type {string}\n         */\n        this.chartType = this.options.chartType;\n\n        /**\n         * whether chart has axes or not\n         * @type {boolean}\n         */\n        this.hasAxes = params.hasAxes;\n\n        /**\n         * whether vertical or not\n         * @type {boolean}\n         */\n        this.isVertical = !!params.isVertical;\n\n        /**\n         * whether chart has group tooltip or not\n         * @type {boolean}\n         */\n        this.hasGroupTooltip = !!tui.util.pick(this.options, 'tooltip', 'grouped');\n\n        /**\n         * data processor\n         * @type {DataProcessor}\n         */\n        this.dataProcessor = this._createDataProcessor(params.DataProcessor || DefaultDataProcessor, params);\n\n        /**\n         * bounds maker\n         * @type {BoundsMaker}\n         */\n        this.boundsMaker = new BoundsMaker({\n            options: this.options,\n            theme: this.theme,\n            dataProcessor: this.dataProcessor,\n            hasAxes: this.hasAxes,\n            isVertical: this.isVertical,\n            chartType: this.chartType\n        });\n\n        /**\n         * component manager\n         * @type {ComponentManager}\n         */\n        this.componentManager = new ComponentManager({\n            dataProcessor: this.dataProcessor,\n            options: this.options,\n            theme: this.theme,\n            boundsMaker: this.boundsMaker,\n            hasAxes: this.hasAxes\n        });\n\n        /**\n         * user event listener\n         * @type {object}\n         */\n        this.userEvent = new UserEventListener();\n\n        /**\n         * original whole legend data\n         * @type {Array.&lt;object>}\n         */\n        this.orgWholeLegendData = this.dataProcessor.getWholeLegendData();\n\n        this._addCustomEventComponent();\n    },\n\n    /**\n     * Create dataProcessor.\n     * @param {DataProcessor} DataProcessor DataProcessor class\n     * @param {object} params parameters\n     *      @params {object} rawData raw data\n     *      @params {{chart: object, chartType: string}} options chart options\n     *      @params {Array} seriesChartTypes series chart types\n     * @returns {object} data processor\n     * @private\n     */\n    _createDataProcessor: function(DataProcessor, params) {\n        var dataProcessor = new DataProcessor(params.rawData),\n            options = params.options;\n\n        dataProcessor.process(params.rawData, options, params.seriesChartTypes);\n        return dataProcessor;\n    },\n\n    /**\n     * Make data for tooltip component.\n     * @returns {object} tooltip data\n     * @private\n     */\n    _makeTooltipData: function() {\n        return {\n            isVertical: this.isVertical,\n            userEvent: this.userEvent,\n            chartType: this.chartType\n        };\n    },\n\n    /**\n     * Add custom event component.\n     * @private\n     * @abstract\n     */\n    _addCustomEventComponent: function() {},\n\n    /**\n     * Make rendering data for axis type chart.\n     * @returns {object} rendering data.\n     * @private\n     */\n    _makeRenderingData: function() {\n        return {};\n    },\n\n    /**\n     * Attach custom evnet.\n     * @param {Array.&lt;object>} serieses serieses\n     * @private\n     */\n    _attachCustomEvent: function(serieses) {\n        var legend = this.componentManager.get('legend');\n\n        serieses = serieses || this.componentManager.where({componentType: 'series'});\n\n        if (legend) {\n            legend.on('changeCheckedLegends', this.onChangeCheckedLegends, this);\n            tui.util.forEach(serieses, function (series) {\n                legend.on(renderUtil.makeCustomEventName('select', series.chartType, 'legend'), series.onSelectLegend, series);\n            }, this);\n        }\n    },\n\n    /**\n     * Make axes data.\n     * @abstract\n     * @private\n     */\n    _makeAxesData: function() {},\n\n    /**\n     * Update percent values.\n     * @private\n     * @abstract\n     */\n    _updatePercentValues: function() {},\n\n    /**\n     * Execute component function.\n     * @param {string} funcName function name\n     * @private\n     */\n    _executeComponentFunc: function(funcName) {\n        this.componentManager.each(function(component) {\n            if (component[funcName]) {\n                component[funcName]();\n            }\n        });\n    },\n\n    /**\n     * Render.\n     * @param {function} callback callback function\n     * @private\n     */\n    _render: function(callback) {\n        var axesData, renderingData;\n\n        this._executeComponentFunc('registerDimension');\n        axesData = this._makeAxesData();\n        this.boundsMaker.registerAxesData(axesData);\n        this._executeComponentFunc('registerAdditionalDimension');\n        this.boundsMaker.registerBoundsData();\n        this._updatePercentValues(axesData);\n        renderingData = this._makeRenderingData(axesData);\n\n        callback(renderingData);\n\n        this._sendSeriesData();\n    },\n\n    /**\n     * Render chart.\n     * @returns {HTMLElement} chart element\n     */\n    render: function() {\n        var el = dom.create('DIV', this.className),\n            that = this;\n\n        dom.addClass(el, 'tui-chart');\n        this._renderTitle(el);\n        renderUtil.renderDimension(el, this.boundsMaker.getDimension('chart'));\n        renderUtil.renderBackground(el, this.theme.chart.background);\n        renderUtil.renderFontFamily(el, this.theme.chart.fontFamily);\n\n        this._render(function(renderingData) {\n            that._renderComponents(renderingData, 'render', el);\n        });\n\n        this._attachCustomEvent();\n        this.chartContainer = el;\n\n        return el;\n    },\n\n    /**\n     * Filter raw data.\n     * @param {object} rawData raw data\n     * @param {Array.&lt;?boolean> | {line: ?Array.&lt;boolean>, column: ?Array.&lt;boolean>}} checkedLegends checked legends\n     * @returns {object} rawData\n     * @private\n     */\n    _filterRawData: function(rawData, checkedLegends) {\n        var cloneData = JSON.parse(JSON.stringify(rawData));\n\n        if (tui.util.isArray(cloneData.series)) {\n            cloneData.series = tui.util.filter(cloneData.series, function(series, index) {\n                return checkedLegends[index];\n            });\n        } else {\n            tui.util.forEach(cloneData.series, function(serieses, chartType) {\n                if (!checkedLegends[chartType]) {\n                    cloneData.series[chartType] = [];\n                } else if (checkedLegends[chartType].length) {\n                    cloneData.series[chartType] = tui.util.filter(serieses, function(series, index) {\n                        return checkedLegends[chartType][index];\n                    });\n                }\n            });\n        }\n\n        return cloneData;\n    },\n\n    /**\n     * Make rerendering data.\n     * @param {object} renderingData rendering data\n     * @param {Array.&lt;?boolean> | {line: ?Array.&lt;boolean>, column: ?Array.&lt;boolean>}} checkedLegends checked legends\n     * @returns {object} rendering data\n     * @private\n     */\n    _makeRerenderingData: function(renderingData, checkedLegends) {\n        var tooltipData = this._makeTooltipData(),\n            serieses = this.componentManager.where({componentType: 'series'});\n\n        renderingData.tooltip = tui.util.extend({\n            checkedLegends: checkedLegends\n        }, tooltipData, renderingData.tooltip);\n\n        tui.util.forEach(serieses, function(series) {\n            renderingData[series.name] = tui.util.extend({\n                checkedLegends: checkedLegends[series.chartType] || checkedLegends\n            }, renderingData[series.name]);\n        });\n\n        return renderingData;\n    },\n\n    /**\n     * Rerender.\n     * @param {Array.&lt;?boolean> | {line: ?Array.&lt;boolean>, column: ?Array.&lt;boolean>}} checkedLegends checked legends\n     * @param {?object} rawData rawData\n     * @param {?object} boundsParams addition params for calculating bounds\n     * @private\n     */\n    _rerender: function(checkedLegends, rawData) {\n        var that = this,\n            newWholeLegendData;\n\n        rawData = rawData || this._filterRawData(this.dataProcessor.getRawData(), checkedLegends);\n\n        this.dataProcessor.process(rawData, this.options, this.seriesChartTypes);\n\n        newWholeLegendData = this.dataProcessor.getWholeLegendData();\n        // 범례 영역은 변경되지 않으므로, bounds 계산에는 변경되지 않은 레이블 데이터를 포함해야 함\n        this.dataProcessor.setWholeLegendData(this.orgWholeLegendData);\n\n        this.boundsMaker.initBoundsData();\n        this._render(function(renderingData) {\n            renderingData = that._makeRerenderingData(renderingData, checkedLegends);\n            that.dataProcessor.setWholeLegendData(newWholeLegendData);\n            that._renderComponents(renderingData, 'rerender');\n        });\n    },\n\n    /**\n     * On change checked legend.\n     * @param {Array.&lt;?boolean> | {line: ?Array.&lt;boolean>, column: ?Array.&lt;boolean>}} checkedLegends checked legends\n     * @param {?object} rawData rawData\n     * @param {?object} boundsParams addition params for calculating bounds\n     */\n    onChangeCheckedLegends: function(checkedLegends, rawData, boundsParams) {\n        this._rerender(checkedLegends, rawData, boundsParams);\n    },\n\n    /**\n     * Render title.\n     * @param {HTMLElement} el target element\n     * @private\n     */\n    _renderTitle: function(el) {\n        var chartOptions = this.options.chart || {},\n            elTitle = renderUtil.renderTitle(chartOptions.title, this.theme.title, 'tui-chart-title');\n\n        dom.append(el, elTitle);\n    },\n\n    /**\n     * Render components.\n     * @param {object} renderingData data for rendering\n     * @param {string} funcName function name for execution\n     * @param {HTMLElement} container container element\n     * @private\n     */\n    _renderComponents: function(renderingData, funcName, container) {\n        var elements = this.componentManager.map(function(component) {\n            var data = renderingData[component.name],\n                element = null;\n\n            if (component[funcName]) {\n                element = component[funcName](data);\n            }\n\n            return element;\n        });\n\n        if (container) {\n            dom.append(container, elements);\n        }\n    },\n\n    /**\n     * Send series data to custom event component.\n     * @private\n     */\n    _sendSeriesData: function() {\n        var customEvent = this.componentManager.get('customEvent'),\n            seriesInfos, chartTypes;\n\n        if (!customEvent) {\n            return;\n        }\n\n        chartTypes = this.chartTypes || [this.chartType];\n        seriesInfos = tui.util.map(chartTypes, function(chartType) {\n            var component = this.componentManager.get(chartType + 'Series') || this.componentManager.get('series');\n\n            return {\n                chartType: chartType,\n                data: component.getSeriesData()\n            };\n        }, this);\n\n        customEvent.initCustomEventData(seriesInfos);\n    },\n\n    /**\n     * Make event name for animation.\n     * @param {string} chartType chart type\n     * @param {string} prefix prefix\n     * @returns {string} event name\n     * @private\n     */\n    _makeAnimationEventName: function(chartType, prefix) {\n        return prefix + chartType.substring(0, 1).toUpperCase() + chartType.substring(1) + 'Animation';\n    },\n\n    /**\n     * Animate chart.\n     */\n    animateChart: function() {\n        this.componentManager.each(function(component) {\n            if (component.animateComponent) {\n                component.animateComponent();\n            }\n        });\n    },\n\n    /**\n     * Register of user event.\n     * @param {string} eventName event name\n     * @param {function} func event callback\n     */\n    on: function(eventName, func) {\n        this.userEvent.register(eventName, func);\n    },\n\n    /**\n     * Update dimension.\n     * @param {{width: number, height: number}} dimension dimension\n     * @returns {boolean} whether updated or not\n     * @private\n     */\n    _updateDimension: function(dimension) {\n        var updated = false;\n\n        if (dimension.width) {\n            this.options.chart.width = dimension.width;\n            updated = true;\n        }\n\n        if (dimension.height) {\n            this.options.chart.height = dimension.height;\n            updated = true;\n        }\n\n        return updated;\n    },\n\n    /**\n     * Public API for resizable.\n     * @param {object} dimension dimension\n     *      @param {number} dimension.width width\n     *      @param {number} dimension.height height\n     * @api\n     */\n    resize: function(dimension) {\n        var that = this,\n            updated;\n\n        if (!dimension) {\n            return;\n        }\n\n        updated = this._updateDimension(dimension);\n\n        if (!updated) {\n            return;\n        }\n\n        this.boundsMaker.initBoundsData(this.options.chart);\n        renderUtil.renderDimension(this.chartContainer, this.boundsMaker.getDimension('chart'));\n\n        this._render(function(renderingData) {\n            that._renderComponents(renderingData, 'resize');\n        });\n    },\n\n    /**\n     * Set tooltip align option.\n     * @param {string} align align (left|center|right, top|middle|bottom)\n     * @api\n     */\n    setTooltipAlign: function(align) {\n        this.componentManager.get('tooltip').setAlign(align);\n    },\n\n    /**\n     * Set position option.\n     * @param {object} position moving position\n     *      @param {number} position.left left\n     *      @param {number} position.top top\n     * @api\n     */\n    setTooltipPosition: function(position) {\n        this.componentManager.get('tooltip').setPosition(position);\n    },\n\n    /**\n     * Reset tooltip align option.\n     * @api\n     */\n    resetTooltipAlign: function() {\n        this.componentManager.get('tooltip').resetAlign();\n    },\n\n    /**\n     * Reset tooltip position.\n     * @api\n     */\n    resetTooltipPosition: function() {\n        this.componentManager.get('tooltip').resetPosition();\n    },\n\n    /**\n     * Show series label.\n     * @api\n     */\n    showSeriesLabel: function() {\n        var serieses = this.componentManager.where({componentType: 'series'});\n\n        tui.util.forEachArray(serieses, function(series) {\n            series.showLabel();\n        });\n    },\n\n    /**\n     * Hide series label.\n     * @api\n     */\n    hideSeriesLabel: function() {\n        var serieses = this.componentManager.where({componentType: 'series'});\n\n        tui.util.forEachArray(serieses, function(series) {\n            series.hideLabel();\n        });\n    }\n});\n\nmodule.exports = ChartBase;\n</code></pre>\n        </article>\n    </section>\n\n\n\n</div>\n\n"